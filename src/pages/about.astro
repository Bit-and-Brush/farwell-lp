---
import { getPageDataWithLayoutData } from "@/api";
import type { GetAboutPageDataResponse } from "@/api/type";
import PageHero from "@/components/common/page-hero.astro";
import KPISection from "@/components/sections/about/kpi-section.astro";
import MissionAndVisionSection from "@/components/sections/about/mission-and-vision-section.astro";
import QualityAssuranceSection from "@/components/sections/about/quality-assurance-section.astro";
import MainLayout from "@/layouts/main-layout.astro";

const [aboutPageData, headerData, footerData] =
  await getPageDataWithLayoutData<GetAboutPageDataResponse>("about");
const { areaClient, catalogFile } = headerData;
const { services, description, contact } = footerData;
const { header, principles, whySection, qualityAssurance } = aboutPageData;
---

<MainLayout
  extendedTitle="Sobre a FARWELL"
  footer={{
    services: services.map(({ title }) => title),
    description,
    contacts:
      contact.map(({ fields: { value, icon } }) => ({ value, icon })) ?? [],
  }}
  headerLinks={{ catalog: catalogFile, clientArea: areaClient }}
>
  <main>
    <PageHero title={header.title} subtitle={header.description} />
    <MissionAndVisionSection
      mission={principles.mission}
      vision={principles.vision}
      values={principles.values}
    />
    <QualityAssuranceSection
      title={qualityAssurance.title}
      description={qualityAssurance.description}
      keyPoints={qualityAssurance.keyPoints.map(({ icon, ...rest }) => ({
        iconUrl: icon,
        ...rest,
      }))}
    />
    <KPISection
      keyPoints={whySection.keyValues.map(({ description, icon, title }) => ({
        description,
        title,
        iconUrl: icon,
      }))}
    />
  </main>
</MainLayout>
